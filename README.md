# Aptos-Workspace-Rabbit-Hole

æ¬¢è¿å°è¯• Aptos Workspace ï¼Œä½ å¯ä»¥è‡ªå·±åˆ›å»ºä¸€ä¸ª Aptos workspace github repoï¼Œå¹¶è·‘å®Œä¸‹é¢çš„æµç¨‹åå¯ä»¥åœ¨ [Build3 - https://www.buildthree.xyz/](https://www.buildthree.xyz/) ä¸­å®Œæˆå¯¹åº”çš„ä½“éªŒä»»åŠ¡å¹¶è·å–ä½“éªŒå¥–åŠ±

**è¦æ±‚å¦‚ä¸‹**ï¼š
- Fork å½“å‰ä»“åº“ï¼Œ æŒ‰ç…§æ­¥éª¤ï¼Œä½“éªŒ `Aptos workspace` å¹¶åˆ›å»º `github repo`
- å°†è¿è¡Œç»“æœä½¿ç”¨ä½“éªŒæ„Ÿå—ï¼Œåé¦ˆå†…å®¹å†™åœ¨ `github repo` ä»“åº“ä¸­çš„ `README.md` ä¸­ ï¼ˆä½¿ç”¨ä½“éªŒå’Œåé¦ˆå†…å®¹ä¸å¾—å°‘äº 20 å­—ä¸”ä¸ºæœ‰æ•ˆåé¦ˆ, ä½¿ç”¨ â€œå¥½ã€ä¸é”™â€ ç­‰åé¦ˆå°†è¢«åˆ¤å®šä¸ºæ— æ•ˆåé¦ˆï¼‰
- åœ¨ `Build3` ä¸­æäº¤ä»»åŠ¡ï¼Œå¹¶æŠŠè‡ªå·±çš„ `github repo` çš„ `URL` æäº¤åˆ°ä»»åŠ¡è¯æ˜ä¸­
- å°†æäº¤ä»»åŠ¡æ—¶ä½¿ç”¨çš„é’±åŒ…åœ°å€æ”¾å…¥ README.d ä¸­ï¼Œé˜²æ­¢å¥–å“è¢«å†’é¢†

| ä»»åŠ¡é“¾æ¥ | ä»»åŠ¡åç§° | ä»»åŠ¡å¥–åŠ± |
|--------|--------|--------|
| [Task]() | ä½“éªŒ Aptos workspace å¹¶åé¦ˆä½¿ç”¨ä½“éªŒ | 1.5 USDT | 


# æ­¤å¤„ä¸ºä»»åŠ¡æäº¤åŒº
**********

### æäº¤ä»»åŠ¡æ—¶ä½¿ç”¨çš„ Aptos é’±åŒ…åœ°å€:
- 0x

### è¿è¡Œç»“æœ
```
XXXXXXXXXXXXXXXXXXXX
```

### ä½¿ç”¨ä½“éªŒï¼š
- XXXXXXXX

### ä½¿ç”¨åé¦ˆ: 
- XXXXXXXX

**********




**github repo çš„ç›®å½•ç¤ºä¾‹**ï¼š
```
- my-workspace-project      // ä½ çš„é¡¹ç›®åç§°(å¯ä»¥éšæ„ä¿®æ”¹) 
  - contract                // åŒ…å«æ‰€æœ‰ Move åŒ…çš„ç›®å½•
    - hello_blockchain      // ä¸€ä¸ªç¤ºä¾‹ Move åŒ…ï¼ŒåŒ…å« hello_blockchain åˆçº¦
      - sources
        - message.move
      - Move.toml
  - tests                   // é›†æˆæµ‹è¯•ç›®å½•
    - my-first-test.ts      // ä½¿ç”¨ `hello_blockchain` çš„é›†æˆæµ‹è¯•
  - tsconfig.testing.json   // æµ‹è¯•è¿è¡Œå™¨çš„é…ç½®æ–‡ä»¶ï¼ˆæˆ‘ä»¬å½“å‰ä½¿ç”¨ Mochaï¼‰
  - workspace.config.ts     // Aptos å·¥ä½œåŒºçš„é…ç½®æ–‡ä»¶
  - README.md               // ç”¨äºå¡«å†™ä½¿ç”¨ä½“éªŒå’Œåé¦ˆå†…å®¹ ï¼ˆä½¿ç”¨ä½“éªŒå’Œåé¦ˆå†…å®¹ä¸å¾—å°‘äº 20 å­—ä¸”ä¸ºæœ‰æ•ˆåé¦ˆ, ä½¿ç”¨ â€œå¥½ã€ä¸é”™â€ ç­‰åé¦ˆå°†è¢«åˆ¤å®šä¸ºæ— æ•ˆåé¦ˆï¼‰
```


# ç¬¬ä¸€ä¸ª Aptos å·¥ä½œåŒºé¡¹ç›®

è¿™æ˜¯ä¸€ä¸ªæ•™ç¨‹ï¼Œå¸¦ä½ ä¸€æ­¥æ­¥åˆ›å»ºä¸€ä¸ªä½¿ç”¨ Aptos å·¥ä½œåŒºçš„ TS/JS é¡¹ç›®ã€‚å®Œæˆåï¼Œä½ å°†æ‹¥æœ‰ä¸€ä¸ªåŠŸèƒ½é½å…¨çš„å¼€å‘ç¯å¢ƒï¼ŒåŒ…å«ä¸€ä¸ªç¤ºä¾‹ Move åˆçº¦å’Œé›†æˆæµ‹è¯•ã€‚

# æ­¥éª¤ 0ï¼šå®‰è£…å…ˆå†³æ¡ä»¶

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ å·²å®‰è£…æ‰€éœ€çš„ä¾èµ–é¡¹ã€‚

è¯·å‚é˜… [Aptos å·¥ä½œåŒº README](https://github.com/aptos-labs/workspace/blob/main/workspace/README.md#prerequisites)ï¼Œå®‰è£…å¦‚ **Docker** ç­‰å¿…è¦çš„å…ˆå†³æ¡ä»¶ã€‚

å¦‚æœä½ å°šæœªå®‰è£… **Node.js** å’Œ **npm**ï¼Œè¯·å‚è€ƒå®˜æ–¹å®‰è£…æŒ‡å—ï¼š

- [https://docs.npmjs.com/downloading-and-installing-node-js-and-npm](https://docs.npmjs.com/downloading-and-installing-node-js-and-npm)

# æ­¥éª¤ 1ï¼šåˆå§‹åŒ– npm é¡¹ç›®

è¦è®¾ç½®é¡¹ç›®ï¼Œè¯·åœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
npm init -y
```

è¿™å°†åˆå§‹åŒ–ä¸€ä¸ª npm åŒ…ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ª `package.json` æ–‡ä»¶ã€‚

ä»¥ä¸‹æ˜¯å®ƒçš„ç¤ºä¾‹å†…å®¹ï¼š

```json
{
  "name": "my-project",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC"
}
```

# æ­¥éª¤ 2ï¼šå®‰è£… Aptos å·¥ä½œåŒº

ç°åœ¨ï¼Œä½œä¸ºå¼€å‘ä¾èµ–é¡¹å®‰è£… **Aptos å·¥ä½œåŒº**ï¼š

```bash
npm install --save-dev @aptos-labs/workspace
```

è¿™ä¼šå°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ° `package.json` ä¸­ï¼š

```json
  "devDependencies": {
    "@aptos-labs/workspace": "^0.0.24"
  }
```

# æ­¥éª¤ 3ï¼šåˆå§‹åŒ– Aptos å·¥ä½œåŒº

æ¥ä¸‹æ¥ï¼Œé€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤åˆå§‹åŒ– Aptos å·¥ä½œåŒºï¼š

```bash
npx aptos-workspace init
```

ä½ å°†è¢«æç¤ºé€‰æ‹© **JavaScript** æˆ– **TypeScript**ã€‚

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­ä½¿ç”¨ **TypeScript**ã€‚

è¯¥å‘½ä»¤ä¼šç”Ÿæˆä»¥ä¸‹é¡¹ç›®ç»“æ„ï¼š

```
- my-project
  - contract                // åŒ…å«æ‰€æœ‰ Move åŒ…çš„ç›®å½•
    - hello_blockchain      // ä¸€ä¸ªç¤ºä¾‹ Move åŒ…ï¼ŒåŒ…å« hello_blockchain åˆçº¦
      - sources
        - message.move
      - Move.toml
  - tests                   // é›†æˆæµ‹è¯•ç›®å½•
    - my-first-test.ts      // ä½¿ç”¨ `hello_blockchain` çš„é›†æˆæµ‹è¯•
  - tsconfig.testing.json   // æµ‹è¯•è¿è¡Œå™¨çš„é…ç½®æ–‡ä»¶ï¼ˆæˆ‘ä»¬å½“å‰ä½¿ç”¨ Mochaï¼‰
  - workspace.config.ts     // Aptos å·¥ä½œåŒºçš„é…ç½®æ–‡ä»¶
```

å¦‚ä¸Šæ‰€ç¤ºï¼Œç”Ÿæˆçš„æ–‡ä»¶åŒ…æ‹¬ä¸€ä¸ªç¤ºä¾‹ **Move åˆçº¦** å’Œä¸€ä¸ª **é›†æˆæµ‹è¯•**ï¼Œå¯ä»¥ç›´æ¥è¿è¡Œã€‚

# æ­¥éª¤ 4ï¼šè¿è¡Œé›†æˆæµ‹è¯•

ä¸ºäº†éªŒè¯ä¸€åˆ‡è®¾ç½®æ­£ç¡®ï¼Œè¿è¡Œé›†æˆæµ‹è¯•ï¼š

```bash
npx aptos-workspace test
```

å¦‚æœä¸€åˆ‡é…ç½®æ­£ç¡®ï¼Œä½ åº”è¯¥çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„è¾“å‡ºï¼š

```
Aptos CLI version 6.0.2 detected.
Docker version 27.5.1 detected.

Spinning up local networks to run tests, this may take a while...

  my first test
    âœ” publish the contract (5866ms)
    âœ” set message (134ms)
    âœ” get message

  3 passing (24s)
```

# ä¸€åˆ‡è®¾ç½®å®Œæˆï¼ğŸ‰

æ­å–œä½ ï¼ä½ åˆšåˆšå®Œæˆäº†ç¬¬ä¸€ä¸ª **Aptos å·¥ä½œåŒº** é¡¹ç›®çš„è®¾ç½®ï¼

ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥æ¢ç´¢ç”Ÿæˆçš„ Move åˆçº¦å’Œé›†æˆæµ‹è¯•ï¼Œäº†è§£å®ƒä»¬æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

## æ¢ç´¢ `hello_blockchain` åˆçº¦

```rust
module hello_blockchain::message {
    use std::error;
    use std::signer;
    use std::string;

    struct MessageHolder has key {
        message: string::String,
    }

    const ENO_MESSAGE: u64 = 0;

    #[view]
    public fun get_message(addr: address): string::String acquires MessageHolder {
        assert!(exists<MessageHolder>(addr), error::not_found(ENO_MESSAGE));
        borrow_global<MessageHolder>(addr).message
    }

    public entry fun set_message(account: signer, message: string::String)
    acquires MessageHolder {
        let account_addr = signer::address_of(&account);
        if (!exists<MessageHolder>(account_addr)) {
            move_to(&account, MessageHolder {
                message,
            })
        } else {
            let old_message_holder = borrow_global_mut<MessageHolder>(account_addr);
            old_message_holder.message = message;
        }
    }
}
```

è¿™ä¸ª **Move æ¨¡å—** å…è®¸ç”¨æˆ·ï¼š

- ä½¿ç”¨ `set_message` **å°†æ¶ˆæ¯å­˜å‚¨åˆ°é“¾ä¸Š**
- ä½¿ç”¨ `get_message` **æ£€ç´¢å­˜å‚¨çš„æ¶ˆæ¯**

## æ¢ç´¢ç¤ºä¾‹é›†æˆæµ‹è¯•

ç”Ÿæˆçš„é›†æˆæµ‹è¯• (`tests/my-first-test.ts`) æ¼”ç¤ºäº†å¦‚ä½•ç¼–å†™ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•å·¥ä½œæµã€‚

**ä¸»è¦ç‰¹ç‚¹**

- ä½¿ç”¨ [mocha](https://mochajs.org/#getting-started) ä½œä¸ºæµ‹è¯•æ¡†æ¶ï¼Œåº”è¯¥å¯¹å¤§å¤šæ•° TS/JS å¼€å‘è€…æ¥è¯´æ¯”è¾ƒç†Ÿæ‚‰ã€‚
- é€šè¿‡å…¨å±€å˜é‡ **`workspace`** æä¾›ä¸€ä¸ª **åŠŸèƒ½é½å…¨çš„ Aptos å®¢æˆ·ç«¯**ï¼Œå…è®¸ä¸æµ‹è¯•ç½‘ç»œäº¤äº’ã€‚
    - æ”¯æŒ [Aptos TypeScript SDK](https://aptos-labs.github.io/aptos-ts-sdk/@aptos-labs/ts-sdk-1.33.2/classes/Aptos.html) ä¸­çš„æ‰€æœ‰åŠŸèƒ½ã€‚

# ä¸‹ä¸€æ­¥ ğŸš€

ç°åœ¨ä½ å·²ç»å®Œæˆäº†ç¯å¢ƒçš„æ­å»ºï¼Œä½ å¯ä»¥ï¼š

- âœ… ä¿®æ”¹ **Move åˆçº¦** ä»¥å®ç°æ›´å¤šåŠŸèƒ½ã€‚
- âœ… æ‰©å±• **é›†æˆæµ‹è¯•**ï¼ŒéªŒè¯æ›´å¤æ‚çš„å·¥ä½œæµã€‚
- âœ… å°è¯•ä¸åŒçš„ **Aptos SDK åŠŸèƒ½**ã€‚

è¿›ä¸€æ­¥æ¢ç´¢ï¼Œè¯·æŸ¥çœ‹ [Aptos æ–‡æ¡£](https://aptos.dev/) å’Œ [Aptos å·¥ä½œåŒº GitHub ä»“åº“](https://github.com/aptos-labs/workspace)ã€‚

ç¥ç¼–ç æ„‰å¿«ï¼ğŸ‰ğŸš€
